{% extends "header.html" %}
{% block check %}
<input type="checkbox" id="switch" class="switch-input" onclick="location.href='main_service.html'">
{% endblock check %}
{% block section %}
{% if session['status']=="product" %}
{% include 'nav_product.html' %}
{% else %}
{% include 'nav_service.html' %}
{% endif %}

<section id="board_view">
    <h2>{{ post['item_name'] }}에 대한 게시글</h2>
    {% if post %}
        <h2>{{ post['title'] }}</h2>
        <p>작성자: {{ post['name'] }}</p>
        <p>작성 날짜: {{ post.date }}</p>
        <div>
            {{ post['content'] }}
        </div>
    {% else %}
        <p>게시글 데이터를 불러올 수 없습니다.</p>
    {% endif %}

    <!-- 수정 버튼 -->
    <button id="modify">수정하기</button>

    <!-- 삭제 버튼 -->
    <button id="delete">삭제하기</button>
        
    <button type="button" onclick="location.href='/board_list/{{ item_name }}/'">뒤로가기</button>

    <script src="path/to/main.js"></script>
</section>

<script> 
const modifyBtn = document.querySelector("#modify"); 
modifyBtn.addEventListener("click", () => { 
    const password = prompt("비밀번호를 입력하세요:"); 
    if (password) { 
        const item_name = "{{ item_name }}"; 
        const post_key = "{{ key }}"; // 게시글의 고유 ID 
        location.href = `/board_modify/${item_name}/${post_key}?password=${password}`; } 
    }
);

const deleteBtn = document.querySelector("#delete"); 
deleteBtn.addEventListener("click", async () => { 
    const password = prompt("비밀번호를 입력하세요:"); 
    if (password) { 
        const item_name = "{{ item_name }}"; 
        const post_key = "{{ key }}"; // 게시글의 고유 ID 
        const response = await fetch(`/delete_post/${item_name}/${post_key}?password=${password}`, { 
            method: 'DELETE' 
        }); 
        if (response.ok) { 
            alert("게시물이 삭제되었습니다."); 
            location.href = `/board_list/${item_name}`; 
            } else { 
                alert("비밀번호가 일치하지 않습니다."); 
            } 
    } 
});
</script>
{% endblock section %}